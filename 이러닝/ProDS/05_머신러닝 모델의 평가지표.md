# 머신러닝 모델의 평가지표

레이블이 범주형인 경우 : **분류모델**

- y가 범주를 나타내는 값

레이블이 연속형 숫자형인 경우 : **회귀모델**

- y가 숫자로 표현되는 값



---

## 회귀 모델의 평가지표

- 오차가 얼마나 작은가를 측정하는 것이 회귀모델 평가지표에서 사용되는 방식

---

실제 Y값을 Yi, i번째 자료의 실제 값

모형을 예측한 경우, i번째 자료의 모형 예측값을 Yi^

=> 오차 : Yi - Yi^

=> 이 차이가 작을 수록 좋은건데,

### RMSE( Root mean square error)

-  그 오차제곱이 평균적으로 얼마일까를 측정한 다음 제곱근함

-  결국 오차의 크기의 평균적인 값을 알고자 하는 것

-  <img src="C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220214220550375.png" alt="image-20220214220550375" style="zoom: 33%;" />

-  RMSE를 구할 때 오차를 제곱해서 평균의 제곱근을 구하는 이유
   - Yi^ ( 파란선) 이 Yi보다 클 수도 있고 작을 수도 있는데( 파란선 위 아래의 점들)
   - 그냥 단순하게 더해버리면 +, -가 서로 상쇄되어버려서 제곱해서 더한 다음, 제곱은 해석이 어려우니 제곱근을 취하는 것


### R-square(결정계수)

-  선형회귀 모델에서 계산된 R-square일 경우에 언제나 0~1사이의 값.
-  0이면 안 좋음, 1이면 모델에 완벽한 피팅. 즉 오차가 0인 상태

-  그러니까 결정계수값은 클 수록 좋고 1에 가까우면 좋음

-  결정계수 값 자체로 그래프의 점들이 우리가 찾아낸 모델로 얼마나 잘 요약되어 있는가를 0에서 1사이의 실수값을 표현한 지표로 해석



### MAE (mean absolute error)

- RMSE를 구할 때 오차를 제곱해서 평균의 제곱근을 구했었음
- 절대값의 평균을 구하는 방식
- 오차가 플러스든 마이너스든 오차니 그 절대값의 평균을 구한 것
- 오차가 방생하면 그 오차가 평균적으로 얼만큼 발생한다 이렇게 해석할 수 있음
  - Ex). MAE가 10이면 어떤 추정치에서 발생하는 오차의 크기가 평균적으로 10, +10 이든 -10이든 Yi^를 기준으로 Yi가 위쪽에 있거나 아래쪽에 있거나. +10 또는 -10 그렇게 평균적으로 위아래로 편차를 가진다라고 해석
- 오차의 평균값이기 때문에 작을 수록 좋음


### MAPE (mean average percentage error)

- 절대값의 평균개념이라 MAE랑 비슷한데, MAE는 단순하게 크기를 이용한 것이라면
- MAPE는 실제값에서 오차가 차지하는 비중이 평균적으로 얼마인지를 계산한 개념
- 오차의 평균값이기 때문에 작을 수록 좋음


## 분류모델의 평가지표

### 정오분류표 (confusion matrix)

보통 2개의 범주를 가질 때, 관심범주를 1로 놓고, 관심범주가 아닌 경우를 0으로 놓는다.

스팸메일의 경우 스팸메일이1, 암 진단결과인 경우 암이 1, 치료 여부를 판단할 경우 치료가 1 등등

분류모델은 Y를 바로 맞히는 것이 아니라

실제로 예측하는 것들 Y가 1일 확률. 즉 관심범주일 확률을 예측하는 것. (범주를 직접적으로 맞추는 모델도 있긴 함)

모델이 찾아낸 예측값이 어떤 한계점을 기준으로 분류 기준값을 기준으로 그것보다 크냐 작으냐

Y가 1일 확률을 구해놨는데 그 확률이 0.5보다 크면 1로보고, 그렇지 않으면 0으로 봄. 이런 기준이 필요

보통 디폴트로 0.5를 많이 씀


분류모델을 평가하기 위해서는

테스트 데이터의 레이블과 모델이 찾은 예측값을 1:1로 비교해야 함

총 4가지 경우

D : TP : 실제 1인데 1로 잘 예측한 경우

C : FN : 실제 1인데 0으로 잘못 예측한 경우

B : FP : 실제 0인데 1로 잘못 예측한 경우

A : TN : 실제 0인데 0으로 잘 예측한 경우