# 머신러닝의 기본 개념 밑 방법론의 분류

```
# 머신러닝 # 지도학습 # 회귀 # 분류 # 비지도학습 #군집 #차원축소 # 추천시스템 #강화학습
```

## 머신러닝 기본 개념

### 머신러닝
- 컴퓨터 시스템에 명시적으로 프로그래밍 하지 않더라도 데이터를 스스로 학습하여 문제를 해결할 수 있게 하는 기술
- 사람이 인지하기 어려운 복잡한 규칙과 패턴을 파악하여 의미있는 결과를 얻을 수 있음
- 훨씬 정확, 비용이나 시간의 측면에서 훨씬 더 효과적으로 프로그램을 관리


### 머신러닝의 발전

- 머신러닝의 활용 증가
  - **머신러닝 알고리즘**의 발전
  - **컴퓨팅** 성능의 발전
  - **대용량 데이터**의 축적 및 관리기술 발전


### 머신러닝 방법론의 분류

#### 지도학습 ( Supercised Learning)

- **라벨이 있는** 훈련용 데이터에서, 여러 특성변수를 이용하여 목표변수인 **라벨**을 예측하도록 모델을 학습함

- 라벨의 데이터 타입에 따라 라벨이 연속형이면 **회귀** 알고리즘(regression), 라벨이 범주형이면 **분류** 알고리즘(classification)으로 구분함

- 어떤 변수간의 관계가 있을 때

- 원인에 해당하는 변수(**특성변수**. x)가 있고 그걸 이용해서 어떤 결과(목표변수, 타겟변수, 레이블변수. y) 를 예측하려는 모델

- x를 이용해서 y를 예측하고자 하는데 어떤 구체적인 함수로 y가 설명될 수 있을 것인가. 이 f를 찾는 방식이 지도학습

- 훈련용 데이터 : f를 데이터로부터 학습한다고 표현. 이 학습하는 과정은 이 f가 뭔지 구체적으로 찾는 과정. 이 과정을 훈련이라고 함

- 이 f를 찾기위해 사용되는 데이터가 원인에 따른 결과값이(레이블이) 주어져 있는 데이터를 쓴다는 것

- 특성변수가 여러 개일 수도.. 이 특성변수를 사용해서 목표변수인 레이블을 맞추는 문제를 지도학습용 알고리즘이라고 한다

- 이 때 레이블의 형태가 숫자라면 회귀

  - 형Ex). 중고차의 특성(모델, 연식, 마모 등등)으로 중고차 가격을 예측하는 (가격 = 숫자. 연속형. 회귀)

- 레이블이 범주형이면 분류 알고리즘

  - Ex).대출심사.. 나이, 직장, 가족수 등등으로 연체를 할 것인가 안 할 것인가 예측( 연체 예상 = 범주. 분류형)
  


##### 분류 VS 회귀

- ![image-20220209225806998](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209225806998.png)
- 분류는  두개의 유전자가 있음
- 유전자의 값이 뭐냐에 따라 x축과 y축의 값이 결정됨
- 이 때 레이블 변수는 범주형으로 병에 걸렸는지, 안 걸렸는지로 구분(색상)
- 특성변수만의 공간에서 y를 색상으로 구분한 시각화 가능

- 이때 분류알고리즘이 하는 건 빨간색과 파란색을 분류해주는 분류 경계면을 찾아보겠다는 것이 분류 알고리즘이 하는 것

- 레이블이 있는 변수인데 그 레이블이 변수형
- 그럴 때 어떻게 분류를 시키면 특성변수가 만들어내는 공간이
- y가 각 범주를 나타내는 걸로 잘 분리가 되느냐를 찾아냄


- ![image-20220209225819609](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209225819609.png)
- 회귀는 x에 따른 y만 표현
- x가 여러개가 되면 고차원의 산점도로 표현해야 함
- 레이블 변수가 숫자형. 연속형이라 자기도 축 하나를 차지하고 있음(y축)
- x하나에 따른 y
- 어떤 유전자의 값과 그래서 몇년 간 생존했는가 (생존기간(숫자)
- x에 따라 쭉 나열 했을 때 이 관계를 어떤 함수를 이용해서 요약할 수 있을까
- x가 어떠할 때 생존기간이 얼마로 예측될지
- 이런 목적에서 예측을 하고자 찾아내는 직선과 같은게 바로 회귀분석이 하고자 하는 바



#### 비지도학습 (Unsupervised Learning)

- **라벨이 없는** 훈련용 데이터에서 특징 변수들 간의 관계나 유사성을 기반으로 의미있는 패턴을 추출
- **자율학습**이라고도 함
- **군집화**(clustering), **차원축소**(dimension reduction), **추천시스템**(recommendation) 등에 활용 됨

- y레이블이 없는 상태에서 학습을 함
- y가 없는데 뭘 학습?
- x들만 모아놓고 그 패턴을 학습
- 특성변수들간의 관계와 유사성을 기반으로 하는 패턴을 학습하고자 하는 것이 목적( 쉽게 알지 못하는 그런 패턴)




##### 군집화

- ![image-20220209231033586](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209231033586.png)
- 위 그림은 x가 2개
- 산점도를 보니 거리가 가까운 애들끼리 뭉쳐있는 패턴이 보임
- 거리가 가까운 것들을 클러스터. 군집을 만들어 주는 것
- x들만 있지만 색이 구분되어 있지 않고 얼마나 가까운가를 이용해서 통합하는 과정
- 군집들 간이 얼마나 다른가. 이 패턴을 이용해서 어떤 레이블을 만들어 내는 과정
- Ex). 블로그의 방문자를 예로 들면
- 그 방문자 기록에 특성변수가 방문시간, 어떤 특정검색어를 검색했는가 여부(만화나 영화나..) , 나이대 등을 이용해서
- 유사한 사람들끼리 관찰치를 묶음
- 어떤 클러스터는 젊은 남성이고 만화를 주제로 들어온 그룹
- 어떤 클러스터는 낮시간에 주로 접속을 하고 여행을 주제로 들어온 그룹
- 이런 식으로 자료들의 여러가지 특성변수가 얼마나 비슷한가를 기준으로 관찰치를 몇 개의 덩어리로 쪼개는. 
- 없던 레이블을 붙여줄 수 있는. 군집별로 이름을 붙여줄 수 있는 방식


##### 차원축소

- <img src="C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209232206435.png" alt="image-20220209232206435" style="zoom: 33%;" />
- X부터 Xk. 근데 k가 10만이라면
- 이렇게 데이터 차원이 크면 데이터 패턴을 파악하는데 문제가 생길 수 있음
- 실제로는 y가 있는 경우일 수도 있음
- 예측모형을 만들려고 해도 얘네 가지고 y를 맞히는 예측모형을 만들려고 해도 특성변수의 개수가 너무 많으면 모델링이 잘 안 됨
- 변수가 너ㅓㅓㅓㅓ무 많으니까 패턴을 미리 알아차리기가 힘듦
- 시각화를 할 수 있다면 좋겠지만 10만개를 시각화할 수는 없음
- 이럴 때, y가 있든 없든. 특성변수들만 모아서 차원축소를 함
- X1, X2 이 두개의 변수로 차원축소
- 차원축소의 기본 원리는 10만개의 변수가 가지고 있는 정보를 최대한 많이 반영하되, 소수의 특성변수만 남기겠다


- ![image-20220209232148817](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209232148817.png)

- 예시는 iris 데이터라고 머신러닝, 데이터마이닝, 데이터분석 쪽에서 단골로 등장하는 데이터 셋.
- iris: 붓꽃. 꽃잎의 길이와 너비, 꽃받침의 길이와 너비가 4개의 특징변수로 주어져있음 ( X1, X2, X3, X4 특성변수)
- 또 붓꽃의 종이  setosa, versicolor, virginica 이렇게 3가지 종류로 구분 (Y) 

- 특성변수를 통해 종이 무엇인가를 맞추기 위한.
- 사실 자료 자체는 지도 학습용 자료..
- X와 Y의 연관성. 함수적 관계를 파악하려는 것이 아니라
- 2차원상의 시각화를 하고 싶은 것. y레이블에 따라 색으로 구분.
- 문제는 x가 4개나 있음. 이 4개의 변수를 시각화하려면 불가능.. 이 중 일부만 가능한데 그럼 나머지 변수는 버리게 됨
- 이럴 때 이 4개의 특성변수를변동성을 잘 반영할 수 있는 어떤 점수를 만들어 냄(Principal Component)

- 이 4개의 변수를 가능한한 정보를 손실하지 않도록 하는 2개의 주성분점수(Principal Component)라는 것으로 요약을 해서 이 정보를 고스란히 반영한 2차원상의 산점도의 3가지 색깔로 레이브를 표현
- 이렇게 차원축소는 데이터가 특성변수가 너무 많을 때, 시각화를 하면 특성을 파악하기 좋고,
- 혹은 모델링을 할 때도 변수의 구조가 단순한게 좋은데 특성변수가 많으면 문제를 일으킴. 이럴 떄 이 특성변수의 차원을 압축시키되 가능한 한 많은 정보를 포함하면서 압축이 되게.
- => 예측력을 높이거나 데이터에 대한 해석을 풍부하게 한다거나, 자료의 패턴 파악을 위한 모델링에서 기초적인 정보를 얻는다거나 다양하게 활용이 될 수 있다




#####  추천시스템

- <img src="C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209232438227.png" alt="image-20220209232438227" style="zoom: 50%;" />
- 어떤 사람이 어떤 책을 읽었을 때,
- 그 책과 유사한 다른 책이 있으면 이걸 그 사람에게 추천해줌
- 아이템을 추천해주는 것도 있고



- <img src="C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209232456399.png" alt="image-20220209232456399" style="zoom:50%;" />
- 오른쪽 예시는,  2명의 사람이 어떤 2개의 책을 모두 읽었다는 공통점을 가지고 있다
- 비슷한 분야ㅔ 관심있는 사람이라고 인식하고 학습(알고리즘이)
- 한 사람이 어떤 책을 새로 읽으면 그 책을 다른 사람에게도 추천해줌

- 이것 역시 레이블이 있어서 레이블을 맞추는 것이 아니라
- 단순하게 어떤 아이템을 구입했느냐, 구매정보만 나열되어 있는 특성변수만 주어져 있는 형태의 자료인 것
- 그랬을 때 데이터의 패턴을 학습하는 비지도 학습


#### 강화학습 (Reinforcement Learning)

- 행동하는 주체(agent)가 있고 정책(policy)에 따라 어떤 행동을 했을 때의 상태(state)와 보상(reward)을 바꿔주는 환경(environment)으로 구성됨
- 주체가 매번 어떠한 행동(action)을 하면 환경에 의해 상태와 보상이 바뀌면서 주체는 보상이 가장 커지는 방향으로 계속 학습해 나가게 됨
- <img src="C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209233141606.png" alt="image-20220209233141606" style="zoom:50%;" />

- 딥마인드에서의 알파고, 자율주행 등에 사용되는 알고리즘..
- 어떤 에이전트가 어떤 정책에 따라 액션을 취함
- 그럼 환경이라는게 그 상태와 보상을 결정
- 이때 이 에이전트는 보상을 어떻게 하면 최대로 만들수 있을까라는 측면에서 처음에 액션을 취할 때 정의했던 정책을 변화시킴
- 변화된 정책으로 다시 액션을 취하고 환경이 다시 상태와 보상을 업데이트
- 이 과정이 반복되면서, 에이전트는 보상을 최대화하는 목적에 따라 정책을 계속 업데이트하는 방향으로 학습