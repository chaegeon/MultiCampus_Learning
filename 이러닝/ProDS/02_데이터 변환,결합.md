# 데이터 변환

## 데이터 변환

- 자료변환을 통해 자료의 해석을 쉽고 풍부하게 하기 위한 과정
- 로그변환, 지수변환, 제곱근변환
- 데이터 변환 목적
  - 분포의 대칭화
    - 오른쪽으로 꼬리가 긴 분포는 평균과 중위수는 상당히 차이가 큼. 이런 경우에는 평균이 훨씬 큰 값
    - 보통 분석방법들은 정규가정(대칭)에 대한 분석방법들이 마련되어 있음
    - 정규가정을 따르지 않는 자료들을 대칭화해줌으로써 정규가정하의 분석법들을 적용할 수 있음
  - 산포를 비슷하게 하기 위해
    - 여러그룹을 비교하는 문제에서 특히 위치를 비교할 때, 산포가 비슷하면 데이터를 쉽게 해석하고 분석할 수 있음
  - 변수 간 관계를 단순하게 하기 위해
    - x와 y의 관계가 비선형일 때 선형으로 바꿔줌...?..
    - 회귀분석... 곡선 말고 직선으로 단순화하면 해석하기도 유리하고 여러가지 추론통계 방법들도 잘 개발되어 있다는 장점


### 변환유형

#### 제곱근 변화 VS 제곱 변환

- ![image-20220209004047631](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209004047631.png)
- x는 대칭형인데, x에 제곱을 하면 오른쪽 꼬리가 길어지고, x의 제곱근은 반대로 왼쪽꼬리가 길어 짐
- 1 ,4, 9 -> 제곱근은 1, 2, 3
- 1, 4, 9 -> 제곱은 1, 16, 81
- 이렇게 제곱 변환의 형태는 오른쪽 꼬리를 길게
- 제곱근 변환은 왼쪽 꼬리를 길게
- 바꿔말하자면, `X제곱 -> X -> X제곱근` 형태의 변화는 분포를 왼쪽으로 끌어당겨주는 효과를 가져온다
- 반대로 제곱변환(`X제곱근 -> X -> X제곱`)은 분포를 오른쪽으로 당겨주는 효과

- 원래 분포가 오른쪽 꼬리가 긴 형태는 제곱근 변환을 통해 대칭을 맞춰줌

- 반대로 왼쪽 꼬리가 길면 제곱유형의 변환으로 대칭형으로 변환

- x, y축으로 보자면, x의 값을 키워주거나 y의 값을 줄여주는 방식 중 하나를 취하면 직선이 됨

- ![image-20220209003934901](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209003934901.png)

- x의 값을 키워주는 방식은 제곱 유형의 변환

- y의 값을 줄여주는 방식은 제곱근 유형의 변환


#### 로그 변환 VS 지수변환

- 제곱근 vs 제곱과 비슷하지만, 조금 더 치우침이 많이 생김
- ![image-20220209004520852](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209004520852.png)
- x는 1을 중심으로 대칭모양
- 지수변환을 하면 오른쪽 꼬리가 길어짐
- 로그변환을 하면 왼쪽 꼬리가 길어짐
- 로그 변환은 분포를 왼쪽에서 당겨주는 효과를 가져오고
- 지수변환은 분포를 오른쪽으로 당겨주는 효과
- 분포의 오른쪽 꼬리가 길다면 로그변환을 통해 왼쪽에서 잡아당기면 됨
- 분포의 왼쪽 꼬리가 길다면 지수변환을 통해 오른쪽으로 당겨서 대칭형태로
- ![image-20220209004532301](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209004532301.png)
- 급성장 형태가 아닌, 이렇게 성장하는 경우
- y의 값을 증가시켜주거나 x의 큰값들이 줄어들거나(?)
- y를 기준으로 한다면 지수변환 또는 제곱 변환
- x를 기준으로 한다면 로그변환 또는 제곱근 변환

#### 박스콕스 변환(Box-Cox Transform)

- 원래 자료값을 p승을 해준다는 개념
- 이 때 P가 2, 3, 4 이러면 제곱, 3제곱, 4제곱 이런 제곱 변환이 되는 거고
- P가 1/2 , 1/4, 1/8 이런 식으로 점점 작아지면 제곱근 변환에 해당
- P가 0~1 사이의 값이면 제곱근 유형, 1보다 크면 제곱유형
- P가 0이되면 이건 로그변환
- P가 2, 4, 8이러다 급격하게 무한대로 커지면 지수변환
- ![image-20220209005457030](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209005457030.png)
- X의 이런 형태 변환을 통해서 Y를 만들어 냄
- 이 Y가 x의 변환된 값
- 이 식을 굳이 외울 필요는 없음.. X의 p승을 기억..

- 

- ![image-20220209005518198](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209005518198.png)
- p=1/2 의 경우 직선과 비교했을 때 앞부분은 조금 벌어지는데 뒷부분은 많이 벌어짐
  - -> 오른쪽 꼬리가 긴 형태의 변환에 적절
  - -> 앞에 있는 건 조금 줄어들고(왼쪽부분은 조금 이동)
  - -> 뒤에 있는 건 많이 줄어들고(오른쪽 부분은 많이 이동)


- 점선들..은 얼마나 많이 낮추느냐 강도 차이
- 제일 밑의 p=0이 로그변환이라, 로그변환이 가장 많이 낮추는 형태라고 보면 됨
  - -> 꼬리가 아주 길 때, 대칭을 맞추려면 최대 로그변환까지 생각할 수 있음
- 
- y는 x를 기준으로 똑같은 x에 대해서 그 y값이 점점 더 커지는 형태
- x값이 작을 땐 조금 키우고 x값이 클 땐 많이 키움
  - -> 꼬리가 왼쪽으로 긴 형태를 대칭시킬 때 사용
  - 제곱이 늘어날 수록 급격하게 상승
  - p가 무한대가 되면 지수변환을 의미
- P를 뭘로 할지에 따라 대칭화, 산포 균등화, 변수간의 관계 단순화 등 목적을 고려해서 변환할 수 있음?


## 데이터 결합

- 한번에 두개의 테이블을 결합
- 변수의 구성이 다름 그런데 공통된 부분이 있음
- ![image-20220209010612022](C:\Users\chgeo\AppData\Roaming\Typora\typora-user-images\image-20220209010612022.png)
- X1, X2 // X1, X3
- 변수의 이름만 같다고 공통 변수가 아님. 이럴 땐 변수이름을 다른 걸로 지정하자
- 변수이름만 같은게 아니라 원소. 내용물이 완전히 같지는 않더라도 동일한 속성으로 구성되어 있다면
- 테이블이 결합될 때 Key가 되는 변수가 된다
- 데이터를 결합한 다는 것은 컬럼의 중복을 제거하고 통합하는 것(X1,X2,X1,X3이 아니라 X1,X2,X3)


### 이너조인(Inner Join)

- 두 테이블에서 공통인 키만 가지고 데이터를 결합하는 것
- X1에 ABC // ABD 라면, A,B만 가지고. 즉 교집한에 해당되는 데이터만 남게 된다